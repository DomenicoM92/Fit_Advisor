<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE = edge">
    <meta name="viewport" content="width = device-width, initial-scale = 1">
    <title>Exercise info</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
</head>

<body onload="fillSection()">
    <h1 style="font-size: 500%">&#9432;</h1>
    <div class="card" style="margin:0 auto; padding: 10%">
        <div class="card-body">
          <h1 class="card-title">Name</h1>
          <p id="name" class="card-text"></p>
        </div>
        <div class="card-body">
            <h3 class="card-title">Description</h3>
            <p id="description" class="card-text"></p>
        </div>
        <div class="card-body">
            <h3 class="card-title">Equipment</h3>
            <p id="equipment" class="card-text"></p>
        </div>
        <div class="card-body">
            <h3 class="card-title">Primary Muscles</h3>
            <p id="muscles_primary" class="card-text"></p>
        </div>
        <div class="card-body">
            <h3 class="card-title">Secondary Muscles</h3>
            <p id="muscles_secondary" class="card-text"></p>
        </div>
        <div class="card-body">
            <h3 class="card-title">Category</h3>
            <p id="category" class="card-text"></p>
        </div>
        <div class="container">
            <div class="row">
                <div id="iFrameContainer" class="col">
                    <div class="embed-responsive embed-responsive-16by9">
                        <iframe id="iFrame1" allowfullscreen></iframe>
                    </div>
                    <br>
                    <div class="embed-responsive embed-responsive-16by9">
                        <iframe id="iFrame2" allowfullscreen></iframe>
                    </div>
                </div>
            </div>
            
        </div>
      </div>
      <script>
          function fillSection() {
           var parameters = window.location.href.split("?");
           var sections = parameters[1].split("&");
           for(i = 0; i < sections.length; i++) {
               sections[i] = sections[i].split("%20").join(" ");
           }
           var name = sections[0].replace(/name=/g,"");
           var description = sections[1].replace(/description=/g,"");
           var equipments = sections[2].replace(/equipments=/g,"");
           var muscles_primary = sections[3].replace(/muscles_primary=/g,"");
           var muscles_secondary = sections[4].replace(/muscles_secondary=/g,"");
           var category = sections[5].replace(/category=/g,"");
           category = category.replace(/%22/g,"");
           document.getElementById("name").innerHTML = name.replace(/%/g," ");;
           document.getElementById("description").innerHTML = description.replace(/%/g," ");
           document.getElementById("equipment").innerHTML = equipments;
           document.getElementById("category").innerHTML = category;
           document.getElementById("muscles_primary").innerHTML = muscles_primary;
           
           document.getElementById("muscles_secondary").innerHTML = muscles_secondary;
           var httpReq = new XMLHttpRequest();
            httpReq.open("GET", "/exercise_video", false);
            httpReq.setRequestHeader("name", name);
            httpReq.send();
            if (httpReq.status == 200) {
                var video = JSON.parse(httpReq.response);
                var link1 = "https://www.youtube.com/embed/"+video[0].id;
                var link2 = "https://www.youtube.com/embed/"+video[1].id;
                document.getElementById('iFrameContainer').style.display = "block";
                document.getElementById('iFrame1').setAttribute("src",link1);
                document.getElementById('iFrame2').setAttribute("src",link2);
            }else {
                console.log("error 403 (exceeded number request YouTube API)");
                document.getElementById('iFrameContainer').style.display = "none";
            }
          }
      </script>
</body>

</html>